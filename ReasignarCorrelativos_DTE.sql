--select top 1000 * from col_mov_movimientos order by mov_codigo desc 

set dateformat dmy

declare @codmov int, @correlativo_anual int--Variables del select
declare m_cursor cursor 
for
	select mov_codigo, mov_correlativo_anual, mov_codigo_generacion from col_mov_movimientos 
	where mov_codigo in (
	7445330, 7445312, 7445300, 7445299, 7445298, 7445297, 7445296, 7445295, 7445294, 7445293, 7445292, 7445291, 7445290, 7445289, 7445288, 7445287, 7445286, 7445285, 7445284, 7445283, 7445282, 7445281, 7445280, 7445279, 7445278, 7445277
	, 7445276, 7445275, 7445274, 7445273, 7445272, 7445271, 7445270, 7445269, 7445268, 7445267, 7445266, 7445265, 7445264, 7445263, 7445262, 7445261, 7445260, 7445259, 7445258, 7445257, 7445256, 7445255, 7445254, 7445253, 7445252
	, 7445251, 7445250, 7445249, 7445248, 7445247, 7445246, 7445245, 7445244, 7445243, 7445242, 7445241, 7445240, 7445239, 7445238, 7445237, 7445236, 7445235, 7445234, 7445233, 7445232, 7445231, 7445230, 7445229, 7445228, 7445227
	, 7445226, 7445225, 7445224, 7445223, 7445222, 7445221, 7445220, 7445219, 7445218, 7445217, 7445216, 7445215, 7445214, 7445213, 7445212, 7445211, 7445210, 7445209, 7445208, 7445207, 7445206, 7445205, 7445204, 7445203, 7445202

	, 7445201, 7445200, 7445199, 7445198, 7445197, 7445196, 7445195, 7445194, 7445193, 7445192, 7445191, 7445190, 7445189, 7445188, 7445187, 7445186, 7445185, 7445184, 7445183, 7445182, 7445181, 7445180, 7445179, 7445178, 7445177
	, 7445176, 7445175, 7445174, 7445173, 7445172, 7445171, 7445170, 7445169, 7445168, 7445167, 7445166, 7445165, 7445164, 7445163, 7445162, 7445161, 7445160, 7445159, 7445158, 7445157, 7445156, 7445155, 7445154, 7445153, 7445152
	, 7445151, 7445150, 7445149, 7445148, 7445147, 7445146, 7445145, 7445144, 7445143, 7445142, 7445141, 7445140, 7445139, 7445138, 7445137, 7445136, 7445135, 7445134, 7445133, 7445132, 7445131, 7445130, 7445129, 7445128, 7445127
	, 7445126, 7445125, 7445124, 7445123, 7445122, 7445121, 7445120, 7445119, 7445118, 7445117, 7445116, 7445115, 7445114, 7445113, 7445112, 7445111, 7445110, 7445109, 7445108, 7445107, 7445106, 7445105, 7445104, 7445103, 7445102

	, 7445101, 7445100, 7445099, 7445098, 7445097, 7445096, 7445095, 7445094, 7445093, 7445092, 7445091, 7445090, 7445089, 7445088, 7445087, 7445086, 7445085, 7445084, 7445083, 7445082, 7445081, 7445080, 7445079, 7445078, 7445077
	, 7445076, 7445075, 7445074, 7445073, 7445072, 7445071, 7445070, 7445069, 7445068, 7445067, 7445066, 7445065, 7445064, 7445063, 7445062, 7445061, 7445060, 7445059, 7445058, 7445057, 7445056, 7445055, 7445054, 7445053, 7445052
	, 7445051, 7445050, 7445049, 7445048, 7445047, 7445046, 7445045, 7445044, 7445043, 7445042, 7445041, 7445040, 7445039, 7445038, 7445037, 7445036, 7445035, 7445034, 7445033, 7445032, 7445031, 7445030, 7445029, 7445028, 7445027
	, 7445026, 7445025, 7445024, 7445023, 7445022, 7445021, 7445020, 7445019, 7445018, 7445017, 7445016, 7445015, 7445014, 7445013, 7445012, 7445011, 7445010, 7445009, 7445008, 7445007, 7445006, 7445005, 7445004, 7445003, 7445002

	, 7445001, 7445000, 7444999, 7444998, 7444997, 7444996, 7444995, 7444994, 7444993, 7444992, 7444991, 7444990, 7444989, 7444988, 7444987, 7444986, 7444985, 7444984, 7444983, 7444982, 7444981, 7444980, 7444979, 7444978, 7444977
	, 7444976, 7444975, 7444974, 7444973, 7444972, 7444971, 7444970, 7444969, 7444968, 7444967, 7444966, 7444965, 7444964, 7444963, 7444962, 7444961, 7444960, 7444959, 7444958, 7444957, 7444956, 7444955, 7444954, 7444953, 7444952
	, 7444951, 7444950, 7444949, 7444948, 7444947, 7444946, 7444945, 7444944, 7444943, 7444942, 7444941, 7444940, 7444939, 7444938, 7444937, 7444936, 7444935, 7444934, 7444933, 7444932, 7444931, 7444930, 7444929, 7444928, 7444927
	, 7444926, 7444925, 7444924, 7444923, 7444922, 7444921, 7444920, 7444919, 7444918, 7444917, 7444916, 7444915, 7444914, 7444913, 7444912, 7444911, 7444909, 7444908, 7444907, 7444906, 7444905, 7444904, 7444903, 7444902, 7444901

	, 7444900, 7444899, 7444898, 7444897, 7444896, 7444895, 7444894, 7444893, 7444892, 7444891, 7444890, 7444889, 7444888, 7444887, 7444886, 7444885, 7444884, 7444883, 7444882, 7444881, 7444880, 7444879, 7444878, 7444877, 7444876
	, 7444875, 7444874, 7444873, 7444872, 7444871, 7444870, 7444869, 7444868, 7444867, 7444866, 7444865, 7444863, 7444862, 7444861, 7444860, 7444859, 7444858
	)
open m_cursor
 
fetch next from m_cursor into @codmov, @correlativo_anual
while @@FETCH_STATUS = 0 
begin
	
	if @correlativo_anual < 100
	begin
		print 'Se asgina correlativo'
		declare @nuevo_correlativo int
		select @nuevo_correlativo = isnull(max(correlativo_anual), 0) + 1
		from vst_mh_encabezado_facturas 
		where tipo_dte_numero = 1 and year(fecha_registro_origen) = year(getdate())
		and /*fecha_registro_origen > '2024-01-07 10:44:00.000' and */fecha_registro_origen >= '08/01/2024 09:20:00'
		set @correlativo_anual = @nuevo_correlativo
	end

	select @codmov 'codmov', @correlativo_anual 'correlativo_anual'
	update col_mov_movimientos set mov_correlativo_anual = @correlativo_anual where mov_codigo = @codmov

	print '@codmov: ' + cast(@codmov as varchar(12))
    --select @codmov
    fetch next from m_cursor into @codmov, @correlativo_anual
end      
close m_cursor  
deallocate m_cursor