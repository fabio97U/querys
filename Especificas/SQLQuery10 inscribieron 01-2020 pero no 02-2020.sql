declare @tbl_egresados as table (codper int)
insert into @tbl_egresados (codper)
values (135976), (161015), (147400), (180168), (182143), (169638), (167359), (169538), (162342), (187133), (168780), (182009), (92553), (174893), (184571), (170083), (167548), (171166), (136571), (152316), (185292), (177234), (182444), (182948), (173342), (180835), (180886), (182929), (183770), (162040), (171060), (114113), (181701), (180543), (157170), (179365), (182915), (165123), (178202), (164459), (181862), (178535), (152612), (183845), (185191), (164034), (162287), (180685), (179916), (159249), (116968), (187519), (103321), (182627), (138525), (181496), (182411), (183234), (88491), (161705), (178780), (179843), (181725), (184622), (100504), (166447), (180105), (181036), (179867), (166563), (155388), (175618), (174418), (193382), (16174), (182606), (187557), (165206), (179761), (106864), (144092), (176857), (189701), (98490), (185756), (110935), (133611), (160713), (72699), (89786), (187572), (186941), (174240), (174134), (180297), (161832), (171482), (163148), (174967), (193302), (143660), (186029), (182391), (181255), (184307), (184250), (183991), (159671), (170028), (178391), (181144), (185281), (157068), (101839), (183686), (153737), (177349), (180530), (187043), (176538), (186866), (134951), (181188), (177993), (192149), (159458), (168636), (159371), (168399), (187651), (186276), (175453), (181981), (178633), (184117), (180876), (186938), (155238), (181401), (138320), (181185), (178165), (173014), (180063), (177372), (167541), (145057), (185068), (164851), (105365), (174873), (152978), (182404), (153254), (162855), (179659), (171030), (185419), (178561), (178183), (136693), (180875), (186226), (130476), (186820), (179969), (181122), (172150), (116446), (163129), (186418), (183046), (183522), (181671), (168949), (97804), (165070), (193268), (173565), (170526), (161541), (182727), (107581), (162548), (172738), (183593), (182077), (157287), (171305), (178428), (201575), (153655), (141588), (137192), (170638), (177274), (191374), (178032), (163204), (175515), (183479), (166994), (176490), (183173), (161571), (186395), (175700), (167879), (180576), (181301), (153421), (179660), (177312), (154162), (188389), (149957), (180332), (147412), (178575), (180914), (181256), (181349), (181616), (181023), (186408), (181233), (160243), (142497), (185873), (156289), (92883), (165841), (178896), (176796), (182296), (117369), (185956), (187542), (179780), (180775), (184935), (136688), (181948), (182616), (153553), (153876), (182815), (182738), (172680), (187280), (193402), (178481), (181591), (166493), (185387), (110713), (182450), (178421), (179736), (151264), (181627), (179980), (184545), (180575), (50170), (172084), (99164), (186439), (108510), (182069), (182770), (181419), (187064), (162130), (174510), (180429), (163769), (175079), (85633), (184052), (182578), (115140), (154256), (183934), (186410), (182593), (181478), (166663), (169445), (184194), (181810), (187250), (181246), (166720), (149391), (170989), (183595), (181462), (81550), (174672), (59079), (183222), (162856), (184404), (104654), (148359), (177653), (145486), (181519), (186341), (153528), (180110), (170956), (185380), (178146), (180746), (181797), (172578), (165484), (163110), (186945), (152795), (172182), (137691), (181962), (169607), (168009), (186286), (177808), (171156), (181089), (167875), (182148), (154983), (172245), (112916), (182257), (179733), (101351), (151446), (172200), (87022), (130436), (149826), (151325), (152175), (153651), (180574), (182215), (180058), (186324), (173146), (184114), (187357), (175472), (184261), (178527), (89075), (165025), (103333), (201497), (190918), (50310), (178246), (143474), (134812), (183301), (191221), (186474), (182335), (159531), (161107), (145172), (182136), (158833), (190661), (181967), (152559), (145988), (187430), (171381), (139347), (181469), (170462), (168522), (181846), (167811), (145047), (137054), (105244), (81534), (186475), (186103), (101429), (166594), (180343), (164430), (146964), (154502), (118481), (147041), (163722), (180513), (176807), (181004), (181809), (200359), (171184), (183258), (180494), (174602), (164936), (191658), (168402), (186754), (171987), (175142), (170593), (181784), (180344), (174069), (184620), (173099), (144109), (154586), (174787), (166982), (169871), (184148), (183104), (150749), (172764), (193271), (192510), (167772), (184364), (184145), (186379), (165633), (137238), (161580), (168010), (181209), (144960), (195946), (172115), (159031), (153547), (117613), (184417), (170372), (179886), (182512), (147160), (173453), (150227), (162649), (172946), (141920), (190736), (180598), (153803), (136029), (183967), (151910), (61352), (183692), (158296), (101326), (158165), (189131), (170266), (175016), (93888), (182763), (62107), (168770), (166650), (84780), (167847), (103490), (172513), (109876), (180980), (118199), (181325), (168828), (145874), (178823), (181628), (155454), (92392), (33671), (113829), (151315), (174891), (163701), (180313), (174613), (138081), (183060), (192214), (183246), (162067), (170026), (92630), (180614), (182528), (192450), (182571), (181665), (186507), (182421), (187094), (180032), (191271), (172653), (179321), (166605), (180246), (173784), (182204), (179570), (186279), (170111), (115684), (134214), (172070), (69124), (188446), (172506), (171612), (143666), (186760), (180290), (182141), (181422), (117693), (167579), (180560), (179676), (148817), (174920), (188462), (185994), (187056), (161829), (181451), (173024), (151865), (108676), (175198), (181585), (192183), (160151), (159469), (186920), (171307), (107022), (170594), (190055), (168336), (180896), (147301), (134314), (183036), (151588), (175375), (117267), (152033), (178137), (165199), (25839), (181770), (186936), (201895), (134383), (23398), (182134), (172745), (102926), (172215), (175094), (186801), (74944), (155303)
insert into @tbl_egresados (codper) values
(184986), (184588), (108045), (180060), (94597), (173140), (171775), (181330), (161103), (182654), (171834), (180129), (178451), (182028), (153377), (80079), (181029), (169866), (163989), (147392), (180071), (181392), (172502), (180515), (179789), (149788), (179638), (169937), (99401), (180047), (88632), (157081), (184817), (147871), (6517), (172429), (170962), (182410), (187319), (187322), (186241), (170544), (182467), (170563), (171328), (171729), (181959), (159992), (163001), (167729), (175540), (179697), (184612), (137412), (150948), (152650), (180926), (180257), (164249), (173571), (175279), (191772), (170987), (179854), (176531), (178279), (173203), (162147), (168730), (33139), (181086), (152011), (172153), (173613), (176185), (136741), (187245), (171039), (171566), (158267), (158689), (84185), (172841), (182825), (676), (175799), (96300), (71873), (117208), (65107), (180790), (185667), (200563), (174507), (183022), (180899), (100042), (85937), (180042), (171603), (95621), (144867), (90150), (200912), (48023), (169743), (169794), (180863), (24975), (162709), (55221), (183908), (181891), (169532), (178631), (186892), (171966), (171530), (174247), (153248), (181566), (185570), (191848), (176957), (186322), (156009), (192083), (152375), (182276), (175082), (181458), (181032), (163882), (171425), (183319), (181101), (181609), (115294), (143589), (179715), (169869), (162557), (187501), (177035), (181092), (94735), (181470), (181556), (145396), (189538), (185176), (172696), (183552), (162564), (145958), (189539), (187596), (178026), (159314), (186047), (143094), (164813), (181212), (162402), (158657), (164530), (165750), (181923), (182509), (185333), (168568), (98765), (184730), (181335), (187681), (159129), (171467), (152951), (184344), (98084), (154927), (181275), (135963), (173719), (108811), (173612), (118172), (181976), (154761), (174194), (172678), (179301), (152998), (185144), (134000), (184245), (181581), (172277), (165547), (184377), (180240), (184137), (162155), (187198), (171897), (184696), (145682), (148550), (184678), (178492), (161977), (181183), (183867), (183168), (158213), (155735), (186994), (180514), (186190), (161221), (174673), (185609), (190627), (93219), (152184), (174444), (99030), (144903), (179952), (183952), (179606), (185959), (174814), (162536), (164849), (180286), (179615), (181867), (168551), (148375), (80678), (81601), (148654), (107061), (110926), (139663), (115255), (54979), (185872), (179665), (184182), (199999), (85797), (186954), (180370), (180910), (181381), (199563), (133113), (179388), (180925), (159543), (200232), (136414), (198843), (89659), (180534), (141607), (181692), (186731), (168611), (182268), (192289), (168261), (106214), (181816), (152987), (180365), (159020), (163046), (180536), (199995), (173001), (169314), (154814), (184464), (176885), (173011), (171220), (162103), (190023), (162549), (109883), (143431), (163640), (159276), (149154), (201307), (180342), (92431), (117209), (180595), (180966), (144833), (159871), (108896), (180909), (178414), (145144), (165429), (199993), (183438), (181466), (178791), (116313), (84484), (143919), (182368), (171965), (200892), (146588), (182893), (183787), (154124), (170448), (161308), (186100), (184341), (181174), (183392), (181353), (165595), (180479), (172495), (183353), (186877), (145671), (180398), (181569), (178280), (180974), (177712), (182730), (181369), (182631), (83901), (132259), (182970), (183604), (149314), (164492), (55984), (95397), (186944), (187142), (174955), (204384), (107818), (138938), (97670), (183534), (200414), (34809), (180440), (167794), (181812), (182661), (164468), (169945), (180858), (152533), (173295), (183229), (163062), (186177), (149397), (182733), (163277), (169772), (181150), (172346), (111390), (184475), (174615), (182732), (152550), (169767), (181706), (182600), (182356), (163804), (116219), (191956), (191283), (166416), (191637), (171165), (152448), (180561), (183660), (181442), (161277), (177869), (186500), (173031), (184943), (163591), (46615), (186364), (174199), (155626), (168459), (171311), (170756), (185335), (184752), (154767), (180633), 
(176696), (183736), (186108), (173617), (181789), (183380), (180434), (183842), (183427), (165425), (177867), (156398), (180760), (161431), (181732), (152309), (180323), (180976), (133835), (204500), (171445), (184349), (168929), (174682), (11953), (185103), (185375), (182846), (159640), (178610), (182261), (182861), (184254), (174751), (178700), (161877), (152135), (186726), (185170), (176569), (165606), (149367), (167458), (176956), (89133), (184357), (186689), (187363), (184681), (167007), (183937), (180037), (182254), (171532), (180245), (167597), (170363), (187364), (180565), (165521), (116118), (195452), (190816), (209507), (181733), (174898), (189578), (207548), (181193), (199550), (210267), (206293), (203869), (182690), (213046), (206639), (161457), (200870), (212139), (210332), (202849), (178223), (212978), (183058), (159518), (208067), (210473), (112234), (208664), (212905), (196690), (184729), (198852), (192091), (205868), (201276), (213091), (182149), (205820), (116581), (138909), (108168), (195042), (171599), (112675), (209222), (199823), (205612), (189915), (189916), (195178), (207271), (196884), (157439), (205362), (101620), (197892), (169666), (203990), (209323), (208239), (168865), (196385), (210252), (176849), (187417), (207077), (186133), (200767), (203399), (209208), (211609), (206240), (145985), (206398), (196389), (170357), (210414), (213309), (117419), (148534), (212982), (190614), (184086), (201829), (188607), (207922), (208482), (199162), (191192), (208639), (164987), (193208), (157311), (208288), (170080), (203726), (213307), (163703), (192966), (174457), (212797), (110748), (210402), (206283), (211373), (209429), (208713), (200537)

declare @tbl_pagos table (
per_codigo int, 
per_carnet varchar(16), 
per_nombres_apellidos varchar(255), 
Matricula int, 
Cuota1 int, 
Cuota2 int, 
Cuota3 int, 
Cuota4 int, 
Cuota5 int, 
Cuota6 int
)
insert into @tbl_pagos
exec col_pagos_por_alumno_pivot 1, 122--19053

select pla_alias_carrera, a.per_codigo codper, a.per_carnet Carnet, b.per_nombres Nombres, b.per_apellidos Apellidos, 
b.per_email 'Correo Personal', b.per_email_opcional 'Correo Opcional', b.per_correo_institucional 'Correo institucional',
b.per_telefono 'Telefono', b.per_telefono_oficina 'Telefono oficina', b.per_celular 'Celular', b.per_emer_tel 'Telefono emergencia'
from @tbl_pagos as a
inner join ra_per_personas as b on a.per_codigo = b.per_codigo
inner join ra_alc_alumnos_carrera on alc_codper = b.per_codigo
inner join ra_pla_planes on pla_codigo = alc_codpla
where a.per_codigo not in (select ins_codper from ra_ins_inscripcion where ins_codcil = 123)
and a.per_codigo not in (select codper from @tbl_egresados)--4458
order by pla_alias_carrera, b.per_apellidos