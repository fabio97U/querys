

--create table PAGOS_125_BORRAME (
--	per_codigo int,
--	per_carnet varchar(50),
--	per_nombres_apellidos varchar(201),
--	Matricula int,
--	Cuota1 int,
--	Cuota2 int,
--	Cuota3 int,
--	Cuota4 int,
--	Cuota5 int,
--	Cuota6 int)
--insert into PAGOS_125_BORRAME
--exec dbo.col_pagos_por_alumno_pivot2 2, 125

declare @tbl_inscritos as table (codper int)
insert into @tbl_inscritos (codper)
select distinct ins_codper from ra_ins_inscripcion 
inner join ra_mai_mat_inscritas on mai_codins = ins_codigo
where ins_codcil = 127 --and ins_codper = 84518

--select * from @tbl_inscritos where codper = 231703

select * from PAGOS_125_BORRAME
where (Matricula + Cuota1 + Cuota2 + Cuota3 + Cuota4 + Cuota5 + Cuota6) < 7
and per_codigo in (
select codper from @tbl_inscritos
)

--update ra_ins_inscripcion set ins_codcil = 1 where ins_codper in (
--231193, 225331, 224793, 204009, 227843, 230853, 111281, 189991, 199772, 225132, 200059, 180128, 225619, 220916, 225335, 218200, 225901, 212209, 196060, 230198, 224770, 230829, 217377, 201808, 230831, 184595, 207230, 164314, 228620, 212207, 148259, 231209, 197503, 215070, 207968, 201645, 216378, 225864, 215099, 206400, 201312, 159197, 204305, 229345, 230143, 191167, 162362, 209327, 214998, 182904, 209260, 174439, 215411, 201401, 230090, 189310, 192422, 224172, 200713, 183999, 226696, 219978, 195608, 177537, 161524, 221798, 229077, 221073, 223967, 221268, 198003, 169867, 225680, 228089, 230486, 217909, 199438, 229493, 191513, 215216, 193253, 227899, 226759, 214707, 215273, 199310, 223850, 210103, 226957, 229217, 208201, 215539, 174379, 222329, 226377, 190158, 229570, 201390, 210156, 207218, 225736, 226571, 218080, 220215, 214443, 217476, 224275, 224735, 174437, 225495, 225931, 217814, 184670, 209064, 196187, 227723, 226234, 225362, 201354, 158503, 201596, 193054, 192964, 131323, 208679, 223144, 204311, 195352, 216420, 231206, 195519, 217889, 220254, 218358, 214867, 226549, 224107, 223755, 224527, 169693, 190237, 225229, 105418, 221418, 193418, 208187, 223803, 206251, 144483, 225395, 219071, 217197, 162623, 186204, 209497, 220812, 229382, 192907, 203708, 155069, 204338, 172710, 230653, 222635, 225210, 225729, 206486, 215828, 225634, 225435, 223714, 226213, 230892, 211414, 208031, 206492, 211251, 225251, 215322, 168148, 226684, 219008, 192760, 198797, 186146, 195636, 218626, 186373, 176428, 100922, 225691, 195775, 212368, 161410, 221155, 226867, 189204, 224942, 208207, 203903, 226827, 221410, 204256, 199602, 187423, 191252, 230420, 225160, 206743, 225772, 189876, 215692, 224246, 225646, 229068, 219880, 166364, 215530, 72921, 224060, 231333, 198617, 159866, 208012, 196515, 208613, 167716, 175437, 228645, 216397, 231161, 216527, 223032, 184607, 225702, 226348, 199242, 230336, 197618, 190563, 230113, 220392, 224585, 196915, 212692, 198943, 207742, 229827, 222521, 229245, 197610, 207415, 167908, 209194, 230951, 226811, 230249, 214157, 212443, 181549, 226632, 206228, 216524, 168158, 230897, 206805, 189001, 200177, 210281, 192807, 226528, 226617, 221485, 218868, 226087, 190642, 226927, 225995, 215671, 209984, 183626, 146020, 172127, 225953, 182497, 155171, 221568, 180415, 192270, 226157, 194505, 215237, 217058, 194323, 221843, 183466, 227251, 207931, 199058, 221113, 193396, 209493, 210559, 230734, 215232, 163478, 136399, 208789, 207039, 198534, 200704, 198589, 231150, 209977, 155691, 206147, 174228, 230404, 149366, 190667, 230409, 200622, 181966, 229929, 212582, 221265, 114403, 227109, 103132, 229082, 229461, 231603, 209597, 184514, 210166, 225834, 211932, 230968, 230510, 192102, 208591, 200469, 186419, 199013, 226028, 208200, 213043, 216381, 63577, 183194, 221620, 172796, 163857, 210320, 230498, 215663, 209554, 231344, 146026, 199736, 171559, 231528, 231276, 214698, 218701, 207183, 210124, 206591, 204568, 201935, 190189, 176164, 147481, 229336, 186864, 141315, 215977, 205279, 166992, 231317, 225857, 107865, 203524, 194529, 212695, 141389, 225862, 218601, 194910, 231202, 107950, 218100, 171181, 201614, 223709, 224628, 220187, 178110, 212292, 223459, 225655, 179938, 204283, 220910, 204411, 231490, 58833, 107190, 208023, 221088, 186179, 229364, 180893, 228373, 199735, 153561, 215272, 199038, 28580, 226365, 220911, 223772, 221445, 141568, 204200, 189369, 230858, 224469, 207796, 173513, 203891, 224705, 230154, 199938, 215351, 221384, 169919, 200327, 200502, 216890, 199224, 188829, 230015, 203536, 225056, 228627, 198055, 229383, 184011, 230581, 209380, 197935, 164231, 67893, 212333, 200420, 220909, 163099, 188828, 217816, 162101, 162906, 164930, 200045, 229093, 212771, 226244, 197953, 206654, 207130, 214466, 192943, 200605, 192271, 205575, 193086, 228726, 221452, 224563, 229894, 230706, 183757, 218489, 191261, 230780, 212344, 231104, 224979, 209840, 216429, 231001, 228633, 226799, 198147, 210379, 206382, 158637, 161568, 180411, 213086, 204726, 191952, 224227, 177886, 218925, 191175, 155449, 110616, 192280, 191303, 228026, 162949, 174375, 215218
--) and ins_codcil = 127
declare @tbl_514 as table (codper_514 int)
insert into @tbl_514 (codper_514) values
(163099), (162362), (208613), (224585), (228089), (204256), (229068), (210166), (208789), (194323), (189204), (224469), (189310), (207415), (219978), (220911), (159197), (162623), (192280), (189876), (190189), (230510), (231150), (217058), (214707), (231206), (107190), (226549), (144483), (231209), (174375), (226087), (196187), (28580), (218868), (206400), (225435), (209493), (173513), (198055), (184607), (193086), (200605), (214998), (182497), (207742), (183194), (221620), (216420), (225362), (206591), (212292), (230581), (172796), (206805), (230090), (163857), (114403), (141315), (162949), (174228), (209194), (225729), (198003), (158503), (225857), (186373), (201390), (190563), (229827), (198147), (226684), (220392), (207931), (200469), (225862), (192422), (225251), (221798), (180893), (72921), (199310), (211414), (210379), (218080), (206251), (107950), (217909), (193054), (229894), (215977), (198943), (215671), (224246), (225655), (216378), (193253), (201401), (174437), (225395), (220215), (226213), (67893), (226759), (231202), (191303), (225736), (216397), (226244), (218701), (100922), (174439), (208679), (224275), (218925), (224793), (189001), (215539), (226927), (141568), (228627), (191513), (221485), (230409), (197503), (207039), (220187), (204311), (230853), (198617), (218200), (225634), (225056), (63577), (225646), (215216), (225495), (194529), (207130), (192271), (192760), (103132), (220916), (224227), (226348), (229077), (201614), (224107), (217476), (208201), (214157), (205575), (224705), (225160), (220812), (225210), (199602), (184595), (221265), (221155), (208207), (218100), (209380), (209977), (163478), (181549), (208187), (216381), (169919), (231603), (225901), (203524), (230113), (229082), (226571), (229382), (221568), (214867), (147481), (200622), (223755), (204568), (197935), (210320), (230249), (212443), (184514), (207968), (231490), (225834), (193418), (228026), (200045), (172710), (212344), (186419), (166364), (212692), (203536), (218626), (230498), (215273), (222329), (226696), (226234), (181966), (221843), (212333), (208023), (203903), (210103), (162101), (229345), (220254), (190642), (200059), (212207), (230653), (172127), (229364), (214698), (192807), (206743), (226617), (224628), (207183), (224979), (221410), (200502), (192102), (199242), (199013), (201312), (212771), (215530), (217377), (226827), (224060), (191252), (212209), (195775), (216890), (225619), (226811), (215351), (171181), (177886), (219008), (203891), (230951), (214466), (197953), (229570), (197610), (176164), (200327), (226528), (189991), (229493), (224942), (216524), (226799), (223032), (136399), (221445), (159866), (162906), (155069), (226365), (218489), (230420), (204726), (227899), (186204), (212368), (176428), (107865), (169867), (226867), (230336), (218358), (208031), (196515), (199938), (230706), (228620), (200177), (190237), (216429), (199772), (225953), (230143), (183757), (209260), (161568), (206147), (223967), (131323), (223459), (195519), (212695), (230198), (209327), (149366), (204411), (215692), (225335), (224563), (207230), (215828), (155691), (226157), (58833), (199038), (105418), (225331), (225931), (201808), (225702), (191952), (211932), (224770), (230829), (164930), (161410), (210156), (200420), (204009), (205279), (208012), (199058), (226377), (230968), (200704), (199438), (146026), (206486), (191175), (225772), (221088), (217889), (231333), (230154), (194505), (228726), (155449), (219071), (231001), (153561), (201935), (214443), (207796), (199224), (210559), (191167), (231193), (225864), (141389), (229461), (187423), (194910), (231317), (227251), (228645), (229383), (215322), (206492), (146020), (230858), (191261), (220909), (180415), (192907), (229245), (223803), (178110), (192964), (110616), (186179), (216527), (212582), (223714), (229093), (209840), (201645), (221268), (209984), (189369), (209497), (167716), (224735), (196915), (192943), (164314), (227109), (219880), (225229), (179938), (206228), (222635), (222521), (208591), (158637), (204200), (227723), (225132), (230404), (230015), (180128), (199736), (199735), (225995), (204305), (183626), (215218), (230831), (200713), (182904), (227843), (221418), (186146), (226632), (174379), (220910), (161524), (215237), (223850), (207218), (195608), (175437), (209064), (164231), (231344), (226028), (111281), (148259), (169693), (229336), (230892), (209554), (210124), (221113), (215099), (188829), (198797), (228633), (225680), (155171), (190667), (195636), (215411), (224527), (196060), (211251), (213086), (197618), (231161), (230734), (184011), (221384), (204338), (206654), (183466), (183999), (223144), (198534), (231528), (230780), (204283), (213043), (210281), (208200), (229929), (217814), (217816), (217197), (167908), (221452), (188828), (206382), (215272), (184670), (180411), (166992), (198589), (225691), (231104), (186864), (209597), (226957), (190158), (192270), (228373), (230486), (201354), (201596), (215232), (231276), (168148), (229217), (195352), (203708), (223709), (230897), (221073), (177537), (171559), (224172), (218601), (215663), (193396), (168158), (215070), (223772)
--de los 514 que ya pagaron la 6ta cuota
select per_carnet, per_nombres, per_apellidos_nombres from @tbl_514 
INNER JOIN ra_per_personas ON codper_514 = per_codigo
where codper_514 not in (
select per_codigo from ra_ins_inscripcion
INNER JOIN ra_per_personas ON ins_codper = per_codigo
where ins_codper in (
231193, 225331, 224793, 204009, 227843, 230853, 111281, 189991, 199772, 225132, 200059, 180128, 225619, 220916, 225335, 218200, 225901, 212209, 196060, 230198, 224770, 230829, 217377, 201808, 230831, 184595, 207230, 164314, 228620, 212207, 148259, 231209, 197503, 215070, 207968, 201645, 216378, 225864, 215099, 206400, 201312, 159197, 204305, 229345, 230143, 191167, 162362, 209327, 214998, 182904, 209260, 174439, 215411, 201401, 230090, 189310, 192422, 224172, 200713, 183999, 226696, 219978, 195608, 177537, 161524, 221798, 229077, 221073, 223967, 221268, 198003, 169867, 225680, 228089, 230486, 217909, 199438, 229493, 191513, 215216, 193253, 227899, 226759, 214707, 215273, 199310, 223850, 210103, 226957, 229217, 208201, 215539, 174379, 222329, 226377, 190158, 229570, 201390, 210156, 207218, 225736, 226571, 218080, 220215, 214443, 217476, 224275, 224735, 174437, 225495, 225931, 217814, 184670, 209064, 196187, 227723, 226234, 225362, 201354, 158503, 201596, 193054, 192964, 131323, 208679, 223144, 204311, 195352, 216420, 231206, 195519, 217889, 220254, 218358, 214867, 226549, 224107, 223755, 224527, 169693, 190237, 225229, 105418, 221418, 193418, 208187, 223803, 206251, 144483, 225395, 219071, 217197, 162623, 186204, 209497, 220812, 229382, 192907, 203708, 155069, 204338, 172710, 230653, 222635, 225210, 225729, 206486, 215828, 225634, 225435, 223714, 226213, 230892, 211414, 208031, 206492, 211251, 225251, 215322, 168148, 226684, 219008, 192760, 198797, 186146, 195636, 218626, 186373, 176428, 100922, 225691, 195775, 212368, 161410, 221155, 226867, 189204, 224942, 208207, 203903, 226827, 221410, 204256, 199602, 187423, 191252, 230420, 225160, 206743, 225772, 189876, 215692, 224246, 225646, 229068, 219880, 166364, 215530, 72921, 224060, 231333, 198617, 159866, 208012, 196515, 208613, 167716, 175437, 228645, 216397, 231161, 216527, 223032, 184607, 225702, 226348, 199242, 230336, 197618, 190563, 230113, 220392, 224585, 196915, 212692, 198943, 207742, 229827, 222521, 229245, 197610, 207415, 167908, 209194, 230951, 226811, 230249, 214157, 212443, 181549, 226632, 206228, 216524, 168158, 230897, 206805, 189001, 200177, 210281, 192807, 226528, 226617, 221485, 218868, 226087, 190642, 226927, 225995, 215671, 209984, 183626, 146020, 172127, 225953, 182497, 155171, 221568, 180415, 192270, 226157, 194505, 215237, 217058, 194323, 221843, 183466, 227251, 207931, 199058, 221113, 193396, 209493, 210559, 230734, 215232, 163478, 136399, 208789, 207039, 198534, 200704, 198589, 231150, 209977, 155691, 206147, 174228, 230404, 149366, 190667, 230409, 200622, 181966, 229929, 212582, 221265, 114403, 227109, 103132, 229082, 229461, 231603, 209597, 184514, 210166, 225834, 211932, 230968, 230510, 192102, 208591, 200469, 186419, 199013, 226028, 208200, 213043, 216381, 63577, 183194, 221620, 172796, 163857, 210320, 230498, 215663, 209554, 231344, 146026, 199736, 171559, 231528, 231276, 214698, 218701, 207183, 210124, 206591, 204568, 201935, 190189, 176164, 147481, 229336, 186864, 141315, 215977, 205279, 166992, 231317, 225857, 107865, 203524, 194529, 212695, 141389, 225862, 218601, 194910, 231202, 107950, 218100, 171181, 201614, 223709, 224628, 220187, 178110, 212292, 223459, 225655, 179938, 204283, 220910, 204411, 231490, 58833, 107190, 208023, 221088, 186179, 229364, 180893, 228373, 199735, 153561, 215272, 199038, 28580, 226365, 220911, 223772, 221445, 141568, 204200, 189369, 230858, 224469, 207796, 173513, 203891, 224705, 230154, 199938, 215351, 221384, 169919, 200327, 200502, 216890, 199224, 188829, 230015, 203536, 225056, 228627, 198055, 229383, 184011, 230581, 209380, 197935, 164231, 67893, 212333, 200420, 220909, 163099, 188828, 217816, 162101, 162906, 164930, 200045, 229093, 212771, 226244, 197953, 206654, 207130, 214466, 192943, 200605, 192271, 205575, 193086, 228726, 221452, 224563, 229894, 230706, 183757, 218489, 191261, 230780, 212344, 231104, 224979, 209840, 216429, 231001, 228633, 226799, 198147, 210379, 206382, 158637, 161568, 180411, 213086, 204726, 191952, 224227, 177886, 218925, 191175, 155449, 110616, 192280, 191303, 228026, 162949, 174375, 215218
) and ins_codcil = 1
)


select ra_ins_inscripcion.*, per_carnet, per_nombres, per_apellidos_nombres, per_email, per_correo_institucional from ra_ins_inscripcion
INNER JOIN ra_per_personas ON ins_codper = per_codigo
where ins_codper in (
231193, 225331, 224793, 204009, 227843, 230853, 111281, 189991, 199772, 225132, 200059, 180128, 225619, 220916, 225335, 218200, 225901, 212209, 196060, 230198, 224770, 230829, 217377, 201808, 230831, 184595, 207230, 164314, 228620, 212207, 148259, 231209, 197503, 215070, 207968, 201645, 216378, 225864, 215099, 206400, 201312, 159197, 204305, 229345, 230143, 191167, 162362, 209327, 214998, 182904, 209260, 174439, 215411, 201401, 230090, 189310, 192422, 224172, 200713, 183999, 226696, 219978, 195608, 177537, 161524, 221798, 229077, 221073, 223967, 221268, 198003, 169867, 225680, 228089, 230486, 217909, 199438, 229493, 191513, 215216, 193253, 227899, 226759, 214707, 215273, 199310, 223850, 210103, 226957, 229217, 208201, 215539, 174379, 222329, 226377, 190158, 229570, 201390, 210156, 207218, 225736, 226571, 218080, 220215, 214443, 217476, 224275, 224735, 174437, 225495, 225931, 217814, 184670, 209064, 196187, 227723, 226234, 225362, 201354, 158503, 201596, 193054, 192964, 131323, 208679, 223144, 204311, 195352, 216420, 231206, 195519, 217889, 220254, 218358, 214867, 226549, 224107, 223755, 224527, 169693, 190237, 225229, 105418, 221418, 193418, 208187, 223803, 206251, 144483, 225395, 219071, 217197, 162623, 186204, 209497, 220812, 229382, 192907, 203708, 155069, 204338, 172710, 230653, 222635, 225210, 225729, 206486, 215828, 225634, 225435, 223714, 226213, 230892, 211414, 208031, 206492, 211251, 225251, 215322, 168148, 226684, 219008, 192760, 198797, 186146, 195636, 218626, 186373, 176428, 100922, 225691, 195775, 212368, 161410, 221155, 226867, 189204, 224942, 208207, 203903, 226827, 221410, 204256, 199602, 187423, 191252, 230420, 225160, 206743, 225772, 189876, 215692, 224246, 225646, 229068, 219880, 166364, 215530, 72921, 224060, 231333, 198617, 159866, 208012, 196515, 208613, 167716, 175437, 228645, 216397, 231161, 216527, 223032, 184607, 225702, 226348, 199242, 230336, 197618, 190563, 230113, 220392, 224585, 196915, 212692, 198943, 207742, 229827, 222521, 229245, 197610, 207415, 167908, 209194, 230951, 226811, 230249, 214157, 212443, 181549, 226632, 206228, 216524, 168158, 230897, 206805, 189001, 200177, 210281, 192807, 226528, 226617, 221485, 218868, 226087, 190642, 226927, 225995, 215671, 209984, 183626, 146020, 172127, 225953, 182497, 155171, 221568, 180415, 192270, 226157, 194505, 215237, 217058, 194323, 221843, 183466, 227251, 207931, 199058, 221113, 193396, 209493, 210559, 230734, 215232, 163478, 136399, 208789, 207039, 198534, 200704, 198589, 231150, 209977, 155691, 206147, 174228, 230404, 149366, 190667, 230409, 200622, 181966, 229929, 212582, 221265, 114403, 227109, 103132, 229082, 229461, 231603, 209597, 184514, 210166, 225834, 211932, 230968, 230510, 192102, 208591, 200469, 186419, 199013, 226028, 208200, 213043, 216381, 63577, 183194, 221620, 172796, 163857, 210320, 230498, 215663, 209554, 231344, 146026, 199736, 171559, 231528, 231276, 214698, 218701, 207183, 210124, 206591, 204568, 201935, 190189, 176164, 147481, 229336, 186864, 141315, 215977, 205279, 166992, 231317, 225857, 107865, 203524, 194529, 212695, 141389, 225862, 218601, 194910, 231202, 107950, 218100, 171181, 201614, 223709, 224628, 220187, 178110, 212292, 223459, 225655, 179938, 204283, 220910, 204411, 231490, 58833, 107190, 208023, 221088, 186179, 229364, 180893, 228373, 199735, 153561, 215272, 199038, 28580, 226365, 220911, 223772, 221445, 141568, 204200, 189369, 230858, 224469, 207796, 173513, 203891, 224705, 230154, 199938, 215351, 221384, 169919, 200327, 200502, 216890, 199224, 188829, 230015, 203536, 225056, 228627, 198055, 229383, 184011, 230581, 209380, 197935, 164231, 67893, 212333, 200420, 220909, 163099, 188828, 217816, 162101, 162906, 164930, 200045, 229093, 212771, 226244, 197953, 206654, 207130, 214466, 192943, 200605, 192271, 205575, 193086, 228726, 221452, 224563, 229894, 230706, 183757, 218489, 191261, 230780, 212344, 231104, 224979, 209840, 216429, 231001, 228633, 226799, 198147, 210379, 206382, 158637, 161568, 180411, 213086, 204726, 191952, 224227, 177886, 218925, 191175, 155449, 110616, 192280, 191303, 228026, 162949, 174375, 215218
) and ins_codcil = 1
order by per_apellidos_nombres
--514


--#region DELETE INSCRIPCION
declare @codper int = 193152, @codins int = 0
select @codins = ins_codigo from ra_ins_inscripcion where ins_codper = @codper and ins_codcil = 127
select * from ra_mai_mat_inscritas where mai_codins = @codins
select * from ra_ins_inscripcion where ins_codigo = @codins
select * from ra_mai_mat_inscritas_especial where mai_codins = @codins
--delete from ra_mai_mat_inscritas where mai_codins = @codins
--delete from ra_ins_inscripcion where ins_codigo = @codins
--delete from ra_mai_mat_inscritas_especial where mai_codins = @codins
--#endregion


--+300
select concat('Alumnos inscritos: ', (select count(1) 'materias' from ra_ins_inscripcion where ins_codcil = 127), --7419
	', diplomados inscritos: ', (select count(1) 'diplomados' from dip_amd_alm_modulo where amd_codigo > 27656),
	', inscritos: ', (
		select count (distinct codper) from (
		select ins_codper codper from ra_ins_inscripcion where ins_codcil = 127
		union all
		select amd_codper codper from dip_amd_alm_modulo where amd_codigo > 27656
		) t
	)
	) --2399
	'msj'